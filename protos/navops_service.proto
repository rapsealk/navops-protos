syntax = "proto3";

package navops;

option csharp_namespace = "NavOps.Grpc";

message EnvironmentStepRequest {
    uint32 size = 1;
    repeated uint32 actions = 2;
}

message EnvironmentStepResponse {
    Observation obs = 1;
    float reward = 2;
    bool done = 3;
}

message Observation {
    repeated FleetObservation fleets = 1;
    repeated float target_index_onehot = 2;
    repeated float raycast_hits = 3;
    repeated Battery batteries = 4;
    AimingPoint aiming_point = 5;
    float ammo = 6;
    repeated float speed_level_onehot = 7;
    repeated float steer_level_onehot = 8;
}

message FleetObservation {
    uint32 team_id = 1;
    float hp = 2;
    float fuel = 3;
    bool destroyed = 4;
    bool detected = 5;
    Position position = 6;
    Rotation rotation = 7;
}

message Battery {
    float tilt = 1;
    Rotation rotation = 2;
    bool reloaded = 3;
    float cooldown = 4;
    bool damaged = 5;
    float repair_progression = 6;
}

message Position {
    float x = 1;
    float y = 2;
}

message Rotation {
    float cos = 1;
    float sin = 2;
}

message AimingPoint {
    repeated float range_onehot = 1;
    Rotation rotation = 2;
}

service NavOpsGrpcService {
    rpc CallEnvironmentStep (EnvironmentStepRequest) returns (EnvironmentStepResponse) {}
}